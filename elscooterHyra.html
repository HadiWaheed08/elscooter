<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HyraElscooter</title>
    <link rel="stylesheet" href="elscooter.css">
</head>

<body>

    <h2 id="welcome"></h2>
    <div id="status">Status: Ingen aktiv hyra</div>

    <h3>Hyreshistorik</h3>
    <div id="history"></div>


    <button id="Hyra">HyraElscooter</button>
    <button id="Hyr1timma" style="display: none;">Hyr 1 timma</button> <!-- knapp för att hyra i 5 minuter -->
    <button id="Hyr30minuter" style="display: none;"> Hyr 30 minuter</button> <!-- knapp för att hyra i 30 minuter-->
    <button id="Avsluta" style="display: none;">Avsluta</button><!-- knapp för att avsluta hyr-->
    <p id="output"></p> <!--här visas totala tiden och kostnaden-->
    <script>
        let utText = 0; // total tid i minuter/timmar
        let utKr = 0; // total kostnad i kronor
        let aktivHyra = false;
        let startTid = null;

        const urlParams = new URLSearchParams(window.location.search); // Hämtar URL-parametrar
        const username = urlParams.get('username'); // Hämtar användarnamnet från URL-parametrarna
        document.getElementById('welcome').innerText = `Welcome, ${username}!`; // Visar välkomstmeddelande med användarnamnet


        const Hyra = document.getElementById('Hyra'); // knapp för att hyra elscooter
        const Hyr1timma = document.getElementById('Hyr1timma'); // knapp för att hyra i 5 minuter
        const Hyr30minuter = document.getElementById('Hyr30minuter'); // knapp för att hyra i 30 minuter
        const text = document.getElementById('output'); // element för att visa total tid och kostnad

        if (!username) {
            window.location.href = 'elscooterLogin.html'; // Om inget användarnamn finns skickas man till inloggningssidan
        }
        else {
            document.getElementById('Hyra').addEventListener('click', function () {

                if (aktivHyra) {
                    alert("Du hyr redan en elscooter!");
                    return;
                }

                aktivHyra = true;
                startTid = new Date().toLocaleString();

                document.body.classList.add("hyr-aktiv");
                document.getElementById("status").innerText = "Status: Scooter hyrd"; 
                Hyra.style.display = 'none';
                Avsluta.style.display ='block';
                Hyr1timma.style.display = 'block'; // visa knappen för att hyra i 5 minuter
                Hyr30minuter.style.display = 'block'; // visa knappen för att hyra i 30 minuter


            });

            document.getElementById('welcome').textContent = `Welcome, ${username}!`; // Visar välkommen med användarnamnet
        }
        document.getElementById('Hyr1timma').addEventListener('click', function () { // Händelselyssnare för knappen "Hyr5minuter"
            utKr += 120;// skriver ut 120 kr per click
            utText += 60;// skriver ut 60 minuter per click

            text.textContent = utText + " minuter = " + utKr + " kr "; // Uppdaterar och visar total tid och kostnad¨

            if (utText >= 300) { // Om total tid är 300 minuter eller mer
                alert("Du har nått max hyrestid på 5 timmar. Tack för att du hyrde vår elscooter. Du kan hyra igen efter 5 timmar!");
                Hyr1timma.disabled = true;// gör så att knappen slutar funka
                Hyr30minuter.disabled = true;// gör så att knappen slutar funka
                Hyr1timma.style.display = 'none'; // gömmer knappen för att hyra i 5 minuter
                Hyr30minuter.style.display = 'none'; // gömmer knappen för att hyra i 30 minuter
            }
            else {
                Hyr1timma.disabled = false;// gör så att knappen förtsätter funka
                Hyr30minuter.disabled = false;// gör så att knappen förtsätter funka
            }
        });

        document.getElementById('Hyr30minuter').addEventListener('click', function () { // Händelselyssnare för knappen "Hyr30minuter"
            utKr += 60; // skriver ut 60 kr per click
            utText += 30;// skriver ut 30 minuter per click
            text.textContent = utText + " minuter = " + utKr + " kr "; // Uppdaterar och visar total tid och kostnad
            if (utText >= 300) {// Om total tid är 300 minuter eller mer
                alert("Du har nått max hyrestid på 5 timmar. Tack för att du hyrde vår elscooter. Du kan hyra igen after 5 timmar!")
                Hyr1timma.disabled = true;// gör så att knappen slutar funka
                Hyr30minuter.disabled = true;// gör så att knappen slutar funka
                 Hyr1timma.style.display = 'none'; // gömmer knappen för att hyra i 5 minuter
                Hyr30minuter.style.display = 'none'; // gömmer knappen för att hyra i 30 minuter
            }
            else {
                Hyr1timma.disabled = false;// gör så att knappen förtsätter funka
                Hyr30minuter.disabled = false;// gör så att knappen fortsätter funka
            }


        });

        document.getElementById('Avsluta').addEventListener('click', function () {// Händelselyssnare för knappen "avsluta"
            if(utText >0) { // om texten är större än 0
                alert("Är säker du vill avsluta?")
              Hyr1timma.disabled = true;// gör så att knappen slutar funka
                Hyr30minuter.disabled = true;// gör så att knappen slutar funka
                 Hyr1timma.style.display = 'none'; // gömmer knappen för att hyra i 5 minuter
                Hyr30minuter.style.display = 'none'; // gömmer knappen för att hyra i 30 minuter
                Avsluta.style.display ='none';//gömmer knappen för att hyra i 30 minuter
            }
            else{
                Hyr1timma.disabled = false;// gör så att knappen fortsätter funka
                Hyr30minuter.disabled = false;// gör så att knappen fortsätter funka
               
            }
           

        })

    </script>
</body>

</html>